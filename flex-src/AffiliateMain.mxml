<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:fx="http://ns.adobe.com/mxml/2009"
				xmlns:mx="library://ns.adobe.com/flex/mx"
				xmlns:s="library://ns.adobe.com/flex/spark"
				xmlns:component="view.component.*"
				width="100%" height="100%" layout="absolute"			
				creationComplete="facade.sendNotification(ApplicationFacade.STARTUP_AFFILIATE_APP, this);">	
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->		
	</fx:Declarations>	
	<fx:Style source="/assets/skins/flex_skins.css"/>
	<fx:Script>
		<![CDATA[
			import model.vo.Affiliate;
			[Bindable] public var affiliate:Affiliate;
			private var facade:ApplicationFacade = ApplicationFacade.getInstance() as ApplicationFacade;					
		]]>
	</fx:Script>
	<mx:states>
		<s:State name="stateLogin" />	
		<s:State name="stateRegister" />
		<s:State name="stateMainApplication" />
	</mx:states>
	
	<mx:Image id="imgEye" styleName="imgEye" source="@Embed('/assets/images/occhio.png')" width="50%" height="50%"/>
	<mx:VBox id="vbExt" styleName="vbExt" width="100%" height="100%">
		
		<mx:Box styleName="vbExt" width="100%" height="100%" includeIn="stateLogin">
			<component:LoginForm id="cmpLoginFormAffiliate" />
			<mx:HBox>
				<mx:VBox horizontalAlign="center">
					<mx:Text text="Non sei ancora registrato?" />
					<mx:LinkButton id="lbRegisterAffiliate" label="Registrati" textDecoration="underline" styleName="clearLinkButtonStyle" />
				</mx:VBox>
				<mx:VRule height="40%"/>
				<mx:VBox horizontalAlign="center">
					<mx:Text text="Password dimenticata?" />
					<mx:LinkButton id="lbRecoveryPassword" label="Recupera Password" textDecoration="underline" styleName="clearLinkButtonStyle" />
				</mx:VBox>
			</mx:HBox>
							
		</mx:Box>
		
		<component:RegisterForm id="cmpRegisterFormAffiliate" includeIn="stateRegister"/>
		
		<mx:Box styleName="vbExt" width="100%" height="100%" includeIn="stateMainApplication"> 
			
			
			<mx:ApplicationControlBar   
									  width="80%" 
									  height="50" 
									  styleName="controlBar"
									  >		
				<mx:HBox id="hbControlBar" width="100%" height="80%" verticalAlign="middle">
					
					<mx:Box id="boxNomeOtticoOculista" width="33%">
						<mx:Text id="txUserLoggedIn" color="white" fontSize="30" fontWeight="bold" text="{affiliate.name}"/>	
					</mx:Box>
					
					<mx:Box id="boxButtonSettings" width="33%" horizontalAlign="center" >
						<mx:Button id="bntSettings" icon="@Embed(source='assets/images/gear.png')" downIcon="@Embed(source='assets/images/gear_little.png')"
								   width="45" height="40"/>
					</mx:Box>
					
					<mx:Box id="boxLogout" width="33%" horizontalAlign="right">
						<mx:Button id="btnLogOut" icon="@Embed(source='assets/images/log_out.png')" downIcon="@Embed(source='assets/images/log_out_little.png')"
								   width="45" height="40"/>	
					</mx:Box>
					
				</mx:HBox>
				
			</mx:ApplicationControlBar>
			
			
			<component:VisitPropertiesAffiliateMain id="cmpVisitProperties" />		
			<component:InsertPatientAffiliateMain id="cmpInsertPatient" />
		</mx:Box>
		
	</mx:VBox>	
</mx:Application>